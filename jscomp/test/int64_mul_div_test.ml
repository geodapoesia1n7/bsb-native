open Int64

let commutative_mul result a b = Mt.Eq((result, result), (mul a b, mul b a))

let pairs = [|(-6369178941122375200L, 7864955043652308640L, 710079015173034099L);
  (8962060020293135336L, 7543586149775142988L, 4850684189325050974L);
  (-9161542197404147928L, 899158197241158908L, 8795600396453302198L);
  (3358398961571564092L, 5342919210817653169L, 4145996795967701244L);
  (-6555402073887813520L, 3465340031200066536L, 4181191505921956774L);
  (-4523677527555012358L, 1276543650539578238L, 5812826113188151491L);
  (-6934468553649362855L, 7785647313097762325L, 7241346950344076853L);
  (715203802919571152L, 2516535866514393275L, 5125117419875854192L);
  (-6686627189857547459L, 2421045490088152053L, 6111768411715304745L);
  (9005046258567688786L, 6069658940756524865L, 2129423077748838354L);
  (4936631060534413696L, 2388637287307694757L, 7350192635126770560L);
  (3901525161500002519L, 4523532416698366291L, 9214381841065479661L);
  (4134697148227395296L, 6566552400989074310L, 8132227803860192208L);
  (-2592314958001559136L, 7915289622294445728L, 7964218148684228345L);
  (7848874678168215648L, 4580311104447448800L, 4313239158344332693L);
  (-7811641560663661522L, 1060947535036669291L, 6161652641757280778L);
  (7365507927037276951L, 4600709048432326175L, 3916052862740247561L);
  (1571446117134724284L, 5218915363866200678L, 4960910992197841962L);
  (-6830326887577503896L, 5309972098777932940L, 3743051712101331294L);
  (-5736531007213089380L, 659238999324606124L, 2014771822435221301L)|]


let from_pairs prefix pairs = 
    (Array.to_list @@ Array.mapi (fun i (result,a,b) ->
    (Printf.sprintf "%s_%d" prefix i) , fun _ -> commutative_mul result a b) pairs)

let small_pairs = 
  [| 121L, 11L, 11L;
    126736L, 356L, 356L;
     137176406L, 12346L,   11111L;
     0xffff_ffff_ff_00000L, 0xffff_ffff_ffL,  0x1_00000L;
     -0xffff_ffff_ff_00000L, -0xffff_ffff_ffL,  0x1_00000L;
     (0xd9e118894c02f614L, 0x4_8100_ef7b_b9df_cc5L, 0x6d2c_68b6_0e75_2704L);
   |]
;; Mt.from_pair_suites __FILE__ @@ 
   from_pairs "random" pairs @ 
   
   from_pairs "small" small_pairs
