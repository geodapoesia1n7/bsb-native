#!/bin/bash

set -e

cat >config.ninja <<EOT
# This file is generated by bootstrap.sh.
conf_cflags = -O2
conf_ldflags = -s
# When developing:
# conf_cflags = -g -Wall
# conf_ldlags =
EOT

echo "Building ninja manually..."
srcs=$(ls src/*.cc | grep -v test)
g++ -Wno-deprecated -o ninja.bootstrap $srcs

echo "Building ninja using itself..."
./ninja.bootstrap ninja
rm ninja.bootstrap

echo "Done!"
